{"ast":null,"code":"var _jsxFileName = \"C:\\\\Proyectos\\\\ITAM_System\\\\itam_frontend\\\\src\\\\pages\\\\masterdata\\\\ModeloComputoFormModal.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\n// Asumiendo que 'react-toastify' está disponible en el entorno.\n// En un entorno real, necesitarías importarlo y configurar el <ToastContainer />.\nimport { toast } from 'react-toastify';\nimport { initializeApp } from 'firebase/app';\nimport { getAuth, signInAnonymously, signInWithCustomToken } from 'firebase/auth';\nimport { getFirestore, doc, collection, addDoc, setDoc\n// Usamos onSnapshot solo para la estructura, aunque aquí solo necesitamos 'addDoc' y 'setDoc'.\n} from 'firebase/firestore';\n\n// =========================================================================\n// FIREBASE CONFIG & AUTH SETUP\n// =========================================================================\n\n// Variables globales proporcionadas por el entorno de Canvas\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';\nconst firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};\nconst initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;\nlet db = null;\nlet auth = null;\n\n// =========================================================================\n// MOCK COMPONENTS & API FUNCTIONS\n// =========================================================================\n\n// Ícono SVG de Cierre (X)\nconst CloseIcon = () => /*#__PURE__*/_jsxDEV(\"svg\", {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  fill: \"none\",\n  viewBox: \"0 0 24 24\",\n  strokeWidth: 2.5,\n  stroke: \"currentColor\",\n  className: \"w-6 h-6\",\n  children: /*#__PURE__*/_jsxDEV(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M6 18L18 6M6 6l12 12\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 35,\n    columnNumber: 9\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 34,\n  columnNumber: 5\n}, this);\n\n// MOCK: Componente Modal\n_c = CloseIcon;\nconst Modal = ({\n  show,\n  onClose,\n  title,\n  children\n}) => {\n  if (!show) return null;\n\n  // Capturar clicks fuera del modal para cerrarlo\n  const handleBackdropClick = e => {\n    if (e.target.id === 'modal-backdrop') {\n      onClose();\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"modal-backdrop\",\n    className: \"fixed inset-0 z-50 overflow-y-auto bg-gray-600 bg-opacity-75 transition-opacity\",\n    \"aria-labelledby\": \"modal-title\",\n    role: \"dialog\",\n    \"aria-modal\": \"true\",\n    onClick: handleBackdropClick,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"fixed inset-0 transition-opacity\",\n        \"aria-hidden\": \"true\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"hidden sm:inline-block sm:align-middle sm:h-screen\",\n        \"aria-hidden\": \"true\",\n        children: \"\\u200B\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"sm:flex sm:items-start\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-3 text-center sm:mt-0 sm:text-left w-full\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between items-center border-b pb-2 mb-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"text-xl leading-6 font-extrabold text-gray-900\",\n                  id: \"modal-title\",\n                  children: title\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 69,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  onClick: onClose,\n                  className: \"text-gray-400 hover:text-gray-600 transition duration-150 p-1 rounded-full hover:bg-gray-100 focus:outline-none\",\n                  children: /*#__PURE__*/_jsxDEV(CloseIcon, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 77,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 72,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 68,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: children\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 80,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 66,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 51,\n    columnNumber: 9\n  }, this);\n};\n\n// MOCK: Datos para selects (Se mantienen como mocks ya que la implementación de su API no se proporcionó)\n_c2 = Modal;\nconst mockMarcas = [{\n  id: 'hp',\n  name: 'HP'\n}, {\n  id: 'dell',\n  name: 'Dell'\n}, {\n  id: 'lenovo',\n  name: 'Lenovo'\n}];\nconst mockTiposActivos = [{\n  id: 'laptop',\n  name: 'Laptop'\n}, {\n  id: 'desktop',\n  name: 'Desktop'\n}, {\n  id: 'tablet',\n  name: 'Tablet'\n}];\nconst getMarcas = async () => new Promise(resolve => setTimeout(() => resolve({\n  data: mockMarcas\n}), 300));\nconst getTiposActivos = async () => new Promise(resolve => setTimeout(() => resolve({\n  data: mockTiposActivos\n}), 300));\n\n// =========================================================================\n// FIREBASE IMPLEMENTATION (Reemplazando MOCKS de DB)\n// =========================================================================\n\nconst createModeloComputo = async (payload, userId) => {\n  if (!db || !userId) throw new Error(\"Firestore no está inicializado o el usuario no está autenticado.\");\n\n  // Definimos la ruta para datos privados del usuario (modelos de cómputo)\n  const modelosCollectionRef = collection(db, `artifacts/${appId}/users/${userId}/modelos_computo`);\n\n  // Añadir el documento a la colección\n  const docRef = await addDoc(modelosCollectionRef, payload);\n  console.log(\"Modelo creado con ID: \", docRef.id);\n  return {\n    id: docRef.id,\n    message: 'Created'\n  };\n};\nconst updateModeloComputo = async (id, payload, userId) => {\n  if (!db || !userId) throw new Error(\"Firestore no está inicializado o el usuario no está autenticado.\");\n\n  // Definimos la referencia al documento específico\n  const modeloDocRef = doc(db, `artifacts/${appId}/users/${userId}/modelos_computo`, id);\n\n  // Actualizar el documento\n  await updateDoc(modeloDocRef, payload);\n  console.log(\"Modelo actualizado con ID: \", id);\n  return {\n    id,\n    message: 'Updated'\n  };\n};\n\n// =========================================================================\n// COMPONENTE PRINCIPAL\n// =========================================================================\n\nconst initialFormData = {\n  marca: '',\n  tipo_activo: '',\n  codigo_interno: '',\n  procesador: '',\n  ram: '',\n  almacenamiento: '',\n  tarjeta_grafica: '',\n  interfaz_wifi: true,\n  mac_wifi: '',\n  interfaz_ethernet: true,\n  mac_ethernet: '',\n  interfaz_serial_paralelo: false,\n  serie_cargador: '',\n  cuenta_con_docking: false,\n  serie_docking: '',\n  cuenta_con_pantalla: false,\n  serie_pantalla: '',\n  cuenta_con_teclado: false,\n  serie_teclado: '',\n  cuenta_con_mouse: false,\n  serie_mouse: '',\n  cuenta_con_mochila: false\n};\nconst ModeloComputoFormModal = ({\n  show,\n  onClose,\n  onSaveSuccess,\n  modeloToEdit\n}) => {\n  _s();\n  const [formData, setFormData] = useState(initialFormData);\n  const [marcas, setMarcas] = useState([]);\n  const [tiposActivos, setTiposActivos] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [errors, setErrors] = useState({});\n  const [userId, setUserId] = useState(null);\n  const [isFirestoreReady, setIsFirestoreReady] = useState(false);\n\n  // 1. Inicialización de Firebase y Autenticación\n  useEffect(() => {\n    const initFirebase = async () => {\n      try {\n        const app = initializeApp(firebaseConfig);\n        db = getFirestore(app);\n        auth = getAuth(app);\n        if (initialAuthToken) {\n          await signInWithCustomToken(auth, initialAuthToken);\n        } else {\n          await signInAnonymously(auth);\n        }\n        const user = auth.currentUser;\n        if (user) {\n          setUserId(user.uid);\n          setIsFirestoreReady(true);\n        } else {\n          console.error(\"No se pudo obtener el usuario después de la autenticación.\");\n          toast.error(\"Error de autenticación. No se podrá guardar el modelo.\");\n        }\n      } catch (error) {\n        console.error('Error inicializando Firebase:', error);\n        toast.error('Error de conexión con la base de datos.');\n      }\n    };\n    initFirebase();\n  }, []);\n\n  // 2. Carga de dependencias y datos de edición\n  useEffect(() => {\n    // Cargar datos para selects\n    const loadDependencies = async () => {\n      try {\n        // Aquí usamos los Mocks ya que no se proporcionó la implementación real de estos endpoints\n        const [marcasRes, tiposRes] = await Promise.all([getMarcas(), getTiposActivos()]);\n        setMarcas(marcasRes.data);\n        setTiposActivos(tiposRes.data);\n      } catch (error) {\n        console.error('Error cargando dependencias:', error);\n        toast.error('Error al cargar marcas o tipos de activos.');\n      }\n    };\n    loadDependencies();\n\n    // Cargar datos para edición si existe modeloToEdit\n    if (modeloToEdit) {\n      setFormData(prev => ({\n        ...initialFormData,\n        // Garantiza que todos los campos del modelo se carguen, usando fallback a cadenas vacías para evitar nulls\n        ...modeloToEdit,\n        mac_wifi: modeloToEdit.mac_wifi || '',\n        mac_ethernet: modeloToEdit.mac_ethernet || '',\n        // Asegurar que los booleanos se carguen correctamente\n        interfaz_wifi: !!modeloToEdit.interfaz_wifi,\n        interfaz_ethernet: !!modeloToEdit.interfaz_ethernet,\n        cuenta_con_docking: !!modeloToEdit.cuenta_con_docking\n        // ... y el resto de booleanos\n      }));\n    } else {\n      setFormData(initialFormData);\n    }\n  }, [modeloToEdit]);\n  const handleChange = e => {\n    const {\n      name,\n      value,\n      type,\n      checked\n    } = e.target;\n    const newValue = type === 'checkbox' ? checked : value;\n    setFormData(prev => ({\n      ...prev,\n      [name]: newValue\n    }));\n    setErrors(prev => ({\n      ...prev,\n      [name]: null\n    }));\n  };\n  const handleInterfaceChange = (e, macFieldName) => {\n    const {\n      name,\n      checked\n    } = e.target;\n    setFormData(prev => ({\n      ...prev,\n      [name]: checked,\n      // Borra la MAC si se desactiva la interfaz\n      [macFieldName]: checked ? prev[macFieldName] : ''\n    }));\n    if (!checked) {\n      setErrors(prev => ({\n        ...prev,\n        [macFieldName]: null\n      }));\n    }\n  };\n  const handleAccessoryChange = (e, seriesFieldName) => {\n    const {\n      name,\n      checked\n    } = e.target;\n    setFormData(prev => ({\n      ...prev,\n      [name]: checked,\n      // Borra la serie si se desactiva el accesorio\n      [seriesFieldName]: checked ? prev[seriesFieldName] : ''\n    }));\n    if (!checked) {\n      setErrors(prev => ({\n        ...prev,\n        [seriesFieldName]: null\n      }));\n    }\n  };\n  const validateConditionalFields = (data, newErrors) => {\n    // Validación de MACs\n    if (data.interfaz_wifi && !data.mac_wifi.trim()) {\n      newErrors.mac_wifi = 'La MAC Wi-Fi es obligatoria si la interfaz está marcada.';\n    }\n    if (data.interfaz_ethernet && !data.mac_ethernet.trim()) {\n      newErrors.mac_ethernet = 'La MAC Ethernet es obligatoria si la interfaz está marcada.';\n    }\n\n    // Validación de Series de Accesorios\n    if (data.cuenta_con_docking && !data.serie_docking.trim()) {\n      newErrors.serie_docking = 'La serie de docking es obligatoria si cuenta con docking.';\n    }\n    if (data.cuenta_con_pantalla && !data.serie_pantalla.trim()) {\n      newErrors.serie_pantalla = 'La serie de pantalla es obligatoria si cuenta con pantalla.';\n    }\n    if (data.cuenta_con_teclado && !data.serie_teclado.trim()) {\n      newErrors.serie_teclado = 'La serie de teclado es obligatoria si cuenta con teclado.';\n    }\n    if (data.cuenta_con_mouse && !data.serie_mouse.trim()) {\n      newErrors.serie_mouse = 'La serie de mouse es obligatoria si cuenta con mouse.';\n    }\n  };\n  const validate = data => {\n    const newErrors = {};\n    // Campos obligatorios\n    if (!data.marca.trim()) newErrors.marca = 'La marca es obligatoria.';\n    if (!data.tipo_activo.trim()) newErrors.tipo_activo = 'El tipo de activo es obligatorio.';\n    if (!data.codigo_interno.trim()) newErrors.codigo_interno = 'El Nombre del Modelo es obligatorio.';\n    if (!data.procesador.trim()) newErrors.procesador = 'El procesador es obligatorio.';\n    if (!data.ram.trim()) newErrors.ram = 'La RAM es obligatoria.';\n    if (!data.almacenamiento.trim()) newErrors.almacenamiento = 'El almacenamiento es obligatorio.';\n    validateConditionalFields(data, newErrors);\n    return newErrors;\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!isFirestoreReady || !userId) {\n      toast.error('La conexión con la base de datos aún no está lista. Por favor, espera un momento.');\n      console.error('Firestore not ready. isFirestoreReady:', isFirestoreReady, 'userId:', userId);\n      return;\n    }\n    const findErrors = validate(formData);\n    if (Object.keys(findErrors).length > 0) {\n      setErrors(findErrors);\n      toast.error('Por favor, corrige los errores del formulario.');\n      return;\n    }\n    setLoading(true);\n    try {\n      // El objeto payload para enviar a Firestore\n      const payload = {\n        ...formData\n      };\n\n      // Limpiar valores vacíos para que Firestore no guarde series inhabilitadas con '' (opcional)\n      if (!payload.interfaz_wifi) delete payload.mac_wifi;\n      if (!payload.interfaz_ethernet) delete payload.mac_ethernet;\n      if (!payload.cuenta_con_docking) delete payload.serie_docking;\n      if (!payload.cuenta_con_pantalla) delete payload.serie_pantalla;\n      if (!payload.cuenta_con_teclado) delete payload.serie_teclado;\n      if (!payload.cuenta_con_mouse) delete payload.serie_mouse;\n      if (modeloToEdit) {\n        // Llamada REAL a la función de UPDATE con userId\n        await updateModeloComputo(modeloToEdit.id, payload, userId);\n        toast.success('Modelo de cómputo actualizado exitosamente!');\n      } else {\n        // Llamada REAL a la función de CREATE con userId\n        await createModeloComputo(payload, userId);\n        toast.success('Modelo de cómputo creado exitosamente!');\n      }\n      onSaveSuccess();\n      onClose();\n    } catch (error) {\n      console.error('Error saving modelo:', error.message);\n      // Mostrar un error genérico de la DB\n      toast.error('Error al guardar el modelo de cómputo. Revisa la consola para más detalles.');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const getInputClasses = (name, isSeriesField, isDisabled, isSelect) => {\n    let classes = `mt-1 block w-full rounded-lg border-2 p-2 shadow-sm transition duration-150 ease-in-out `;\n    classes += `border-gray-400 focus:border-indigo-600 focus:ring-2 focus:ring-indigo-300 `;\n    if (isDisabled) {\n      classes += `bg-gray-100 cursor-not-allowed text-gray-500 `;\n    } else {\n      classes += `bg-white text-gray-800 `;\n    }\n    if (errors[name]) {\n      classes += `!border-red-500 `;\n    }\n    if (isSelect) {\n      classes += `appearance-none pr-8 `;\n    }\n    return classes.trim();\n  };\n  const renderInput = (label, name, type = 'text', required = true, isConditional = false, seriesOrMacFieldName = null) => {\n    const isCheckbox = type === 'checkbox';\n    const isSelect = type === 'select';\n    const isSeriesField = name.startsWith('serie_');\n    let isDisabled = false;\n\n    // LÓGICA DE DESHABILITACIÓN MEJORADA: \n    if (name === 'mac_wifi') {\n      isDisabled = !formData.interfaz_wifi;\n    } else if (name === 'mac_ethernet') {\n      isDisabled = !formData.interfaz_ethernet;\n    } else if (isSeriesField && name !== 'serie_cargador') {\n      const controlField = name.replace('serie_', 'cuenta_con_');\n      isDisabled = !formData[controlField];\n    }\n    const handleSpecificChange = e => {\n      if (name === 'interfaz_wifi') {\n        handleInterfaceChange(e, 'mac_wifi');\n      } else if (name === 'interfaz_ethernet') {\n        handleInterfaceChange(e, 'mac_ethernet');\n      } else if (isConditional) {\n        // Para checkboxes de accesorios (cuenta_con_X)\n        handleAccessoryChange(e, seriesOrMacFieldName);\n      } else {\n        // Para todos los demás campos (text, select, checkbox simple)\n        handleChange(e);\n      }\n    };\n    const isMacRequired = name === 'mac_wifi' && formData.interfaz_wifi || name === 'mac_ethernet' && formData.interfaz_ethernet;\n    // La validación `validate` se encarga de esto, pero mantenemos el asterisco\n    const finalRequired = required || isMacRequired || isSeriesField && formData[name.replace('serie_', 'cuenta_con_')];\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"block text-sm font-semibold text-gray-700\",\n        children: [label, \" \", (required || isMacRequired) && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-red-500\",\n          children: \"*\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 423,\n          columnNumber: 61\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 17\n      }, this), isSelect ? /*#__PURE__*/_jsxDEV(\"select\", {\n        name: name,\n        value: formData[name] || '',\n        onChange: handleChange,\n        className: getInputClasses(name, false, false, true),\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"Seleccione...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 433,\n          columnNumber: 25\n        }, this), (name === 'marca' ? marcas : tiposActivos).map(item => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: item.id,\n          children: item.name\n        }, item.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 435,\n          columnNumber: 29\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 427,\n        columnNumber: 21\n      }, this) : isCheckbox ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center h-full pt-1\",\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"checkbox\",\n          name: name,\n          checked: formData[name],\n          onChange: handleSpecificChange,\n          className: \"h-5 w-5 text-indigo-600 border-gray-400 rounded focus:ring-indigo-500\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 440,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 439,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(\"input\", {\n        type: type,\n        name: name,\n        value: formData[name] || '',\n        onChange: handleChange,\n        className: getInputClasses(name, isSeriesField, isDisabled, false),\n        disabled: isDisabled,\n        placeholder: isDisabled ? 'N/A' : name.startsWith('mac_') ? 'Ej: AA:BB:CC:DD:EE:FF' : ''\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 449,\n        columnNumber: 21\n      }, this), errors[name] && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-1 text-xs text-red-600 font-medium\",\n        children: errors[name]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 460,\n        columnNumber: 34\n      }, this)]\n    }, name, true, {\n      fileName: _jsxFileName,\n      lineNumber: 421,\n      columnNumber: 13\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    show: show,\n    onClose: onClose,\n    title: modeloToEdit ? \"Editar Modelo de Cómputo\" : \"Crear Modelo de Cómputo\",\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      className: \"space-y-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-2 gap-6\",\n        children: [renderInput('Nombre Modelo', 'codigo_interno'), renderInput('Marca', 'marca', 'select'), renderInput('Tipo de Activo', 'tipo_activo', 'select'), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"h-0 invisible\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 480,\n          columnNumber: 21\n        }, this), \" \", /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-span-1 md:col-span-2 border-t pt-4\",\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-bold text-gray-800 mb-2\",\n            children: \"Especificaciones de Hardware\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 484,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 483,\n          columnNumber: 21\n        }, this), renderInput('Procesador', 'procesador'), renderInput('Tarjeta Gráfica', 'tarjeta_grafica', 'text', false), renderInput('RAM (Ej: 16GB)', 'ram'), renderInput('Almacenamiento (Ej: 512GB SSD)', 'almacenamiento'), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-span-1 md:col-span-2 border-t pt-4\",\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-bold text-gray-800 mb-2\",\n            children: \"Interfaces de Red y Direcci\\xF3n MAC\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 496,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 495,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-3 border rounded-xl shadow-inner bg-indigo-50/70\",\n          children: [renderInput('Incluye Interfaz WiFi', 'interfaz_wifi', 'checkbox', false, true, 'mac_wifi'), renderInput('MAC Address Wi-Fi', 'mac_wifi', 'text', false)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 500,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-3 border rounded-xl shadow-inner bg-indigo-50/70\",\n          children: [renderInput('Incluye Interfaz Ethernet', 'interfaz_ethernet', 'checkbox', false, true, 'mac_ethernet'), renderInput('MAC Address Ethernet', 'mac_ethernet', 'text', false)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 506,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-span-1 md:col-span-2 pt-2\",\n          children: renderInput('Interfaz Serial/Paralelo', 'interfaz_serial_paralelo', 'checkbox', false)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 512,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-span-1 md:col-span-2 border-t pt-4\",\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-bold text-gray-800 mb-2\",\n            children: \"Accesorios y Series\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 518,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 517,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-span-1 md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6\",\n          children: [renderInput('Serie de Cargador', 'serie_cargador', 'text', false), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-end\",\n            children: renderInput('Cuenta con Mochila', 'cuenta_con_mochila', 'checkbox', false)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 526,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-3 border rounded-xl shadow-inner bg-yellow-50/50\",\n            children: [renderInput('Cuenta con Docking', 'cuenta_con_docking', 'checkbox', false, true, 'serie_docking'), renderInput('Serie de Docking', 'serie_docking', 'text', false, false)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 528,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-3 border rounded-xl shadow-inner bg-yellow-50/50\",\n            children: [renderInput('Cuenta con Pantalla', 'cuenta_con_pantalla', 'checkbox', false, true, 'serie_pantalla'), renderInput('Serie de Pantalla', 'serie_pantalla', 'text', false, false)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 532,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-3 border rounded-xl shadow-inner bg-yellow-50/50\",\n            children: [renderInput('Cuenta con Teclado', 'cuenta_con_teclado', 'checkbox', false, true, 'serie_teclado'), renderInput('Serie de Teclado', 'serie_teclado', 'text', false, false)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 537,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-3 border rounded-xl shadow-inner bg-yellow-50/50\",\n            children: [renderInput('Cuenta con Mouse', 'cuenta_con_mouse', 'checkbox', false, true, 'serie_mouse'), renderInput('Serie de Mouse', 'serie_mouse', 'text', false, false)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 541,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 522,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 474,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-end space-x-3 border-t pt-6 mt-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: onClose,\n          className: \"px-6 py-2 text-sm font-semibold text-gray-700 bg-white border border-gray-300 rounded-xl shadow-md hover:bg-gray-100 transition duration-150\",\n          disabled: loading,\n          children: \"Cancelar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 550,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"px-6 py-2 text-sm font-semibold text-white bg-indigo-600 rounded-xl shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-300 transition duration-150\",\n          disabled: loading || !isFirestoreReady,\n          children: loading ? 'Guardando...' : 'Guardar Modelo'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 558,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 549,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 472,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 467,\n    columnNumber: 9\n  }, this);\n};\n\n// Componente Wrapper para simular el uso en el entorno principal\n// Este componente de prueba solo sirve para que el Formulario sea visible y funcional\n_s(ModeloComputoFormModal, \"Rv5FW7do9YTW+3lebOaChnItRBQ=\");\n_c3 = ModeloComputoFormModal;\nconst App = () => {\n  _s2();\n  const [showModal, setShowModal] = useState(false);\n\n  // Función de MOCK para el toast\n  if (typeof toast === 'undefined') {\n    window.toast = {\n      success: msg => console.log('SUCCESS:', msg),\n      error: msg => console.error('ERROR:', msg)\n    };\n  }\n\n  // MOCK para manejar el éxito del guardado\n  const handleSaveSuccess = () => {\n    console.log(\"Modelo guardado exitosamente. Actualizar la tabla de modelos aquí.\");\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-8 bg-gray-50 min-h-screen\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-3xl font-extrabold text-gray-900 mb-8\",\n      children: \"Prueba del Formulario de Modelo de C\\xF3mputo\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 591,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => setShowModal(true),\n      className: \"px-4 py-2 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 transition\",\n      children: \"Abrir Formulario\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 594,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(ModeloComputoFormModal, {\n      show: showModal,\n      onClose: () => setShowModal(false),\n      onSaveSuccess: handleSaveSuccess,\n      modeloToEdit: null // Pasa un objeto si quieres probar la edición\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 601,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 590,\n    columnNumber: 9\n  }, this);\n};\n_s2(App, \"uVlnG5KLfXemZk5i5Fl+Cg356FU=\");\n_c4 = App;\nexport default App;\nvar _c, _c2, _c3, _c4;\n$RefreshReg$(_c, \"CloseIcon\");\n$RefreshReg$(_c2, \"Modal\");\n$RefreshReg$(_c3, \"ModeloComputoFormModal\");\n$RefreshReg$(_c4, \"App\");","map":{"version":3,"names":["React","useState","useEffect","toast","initializeApp","getAuth","signInAnonymously","signInWithCustomToken","getFirestore","doc","collection","addDoc","setDoc","jsxDEV","_jsxDEV","appId","__app_id","firebaseConfig","__firebase_config","JSON","parse","initialAuthToken","__initial_auth_token","db","auth","CloseIcon","xmlns","fill","viewBox","strokeWidth","stroke","className","children","strokeLinecap","strokeLinejoin","d","fileName","_jsxFileName","lineNumber","columnNumber","_c","Modal","show","onClose","title","handleBackdropClick","e","target","id","role","onClick","type","_c2","mockMarcas","name","mockTiposActivos","getMarcas","Promise","resolve","setTimeout","data","getTiposActivos","createModeloComputo","payload","userId","Error","modelosCollectionRef","docRef","console","log","message","updateModeloComputo","modeloDocRef","updateDoc","initialFormData","marca","tipo_activo","codigo_interno","procesador","ram","almacenamiento","tarjeta_grafica","interfaz_wifi","mac_wifi","interfaz_ethernet","mac_ethernet","interfaz_serial_paralelo","serie_cargador","cuenta_con_docking","serie_docking","cuenta_con_pantalla","serie_pantalla","cuenta_con_teclado","serie_teclado","cuenta_con_mouse","serie_mouse","cuenta_con_mochila","ModeloComputoFormModal","onSaveSuccess","modeloToEdit","_s","formData","setFormData","marcas","setMarcas","tiposActivos","setTiposActivos","loading","setLoading","errors","setErrors","setUserId","isFirestoreReady","setIsFirestoreReady","initFirebase","app","user","currentUser","uid","error","loadDependencies","marcasRes","tiposRes","all","prev","handleChange","value","checked","newValue","handleInterfaceChange","macFieldName","handleAccessoryChange","seriesFieldName","validateConditionalFields","newErrors","trim","validate","handleSubmit","preventDefault","findErrors","Object","keys","length","success","getInputClasses","isSeriesField","isDisabled","isSelect","classes","renderInput","label","required","isConditional","seriesOrMacFieldName","isCheckbox","startsWith","controlField","replace","handleSpecificChange","isMacRequired","finalRequired","onChange","map","item","disabled","placeholder","onSubmit","_c3","App","_s2","showModal","setShowModal","window","msg","handleSaveSuccess","_c4","$RefreshReg$"],"sources":["C:/Proyectos/ITAM_System/itam_frontend/src/pages/masterdata/ModeloComputoFormModal.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\n// Asumiendo que 'react-toastify' está disponible en el entorno.\r\n// En un entorno real, necesitarías importarlo y configurar el <ToastContainer />.\r\nimport { toast } from 'react-toastify'; \r\nimport { initializeApp } from 'firebase/app';\r\nimport { getAuth, signInAnonymously, signInWithCustomToken } from 'firebase/auth';\r\nimport { \r\n    getFirestore, \r\n    doc, \r\n    collection, \r\n    addDoc, \r\n    setDoc, \r\n    // Usamos onSnapshot solo para la estructura, aunque aquí solo necesitamos 'addDoc' y 'setDoc'.\r\n} from 'firebase/firestore';\r\n\r\n// =========================================================================\r\n// FIREBASE CONFIG & AUTH SETUP\r\n// =========================================================================\r\n\r\n// Variables globales proporcionadas por el entorno de Canvas\r\nconst appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';\r\nconst firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};\r\nconst initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;\r\n\r\nlet db = null;\r\nlet auth = null;\r\n\r\n// =========================================================================\r\n// MOCK COMPONENTS & API FUNCTIONS\r\n// =========================================================================\r\n\r\n// Ícono SVG de Cierre (X)\r\nconst CloseIcon = () => (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={2.5} stroke=\"currentColor\" className=\"w-6 h-6\">\r\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M6 18L18 6M6 6l12 12\" />\r\n    </svg>\r\n);\r\n\r\n// MOCK: Componente Modal\r\nconst Modal = ({ show, onClose, title, children }) => {\r\n    if (!show) return null;\r\n\r\n    // Capturar clicks fuera del modal para cerrarlo\r\n    const handleBackdropClick = (e) => {\r\n        if (e.target.id === 'modal-backdrop') {\r\n            onClose();\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div \r\n            id=\"modal-backdrop\"\r\n            className=\"fixed inset-0 z-50 overflow-y-auto bg-gray-600 bg-opacity-75 transition-opacity\" \r\n            aria-labelledby=\"modal-title\" \r\n            role=\"dialog\" \r\n            aria-modal=\"true\"\r\n            onClick={handleBackdropClick}\r\n        >\r\n            <div className=\"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0\">\r\n                <div className=\"fixed inset-0 transition-opacity\" aria-hidden=\"true\"></div>\r\n                <span className=\"hidden sm:inline-block sm:align-middle sm:h-screen\" aria-hidden=\"true\">&#8203;</span>\r\n                \r\n                <div className=\"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full\">\r\n                    <div className=\"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4\">\r\n                        <div className=\"sm:flex sm:items-start\">\r\n                            <div className=\"mt-3 text-center sm:mt-0 sm:text-left w-full\">\r\n                                {/* Encabezado con título y botón de cerrar en la esquina */}\r\n                                <div className=\"flex justify-between items-center border-b pb-2 mb-4\">\r\n                                    <h3 className=\"text-xl leading-6 font-extrabold text-gray-900\" id=\"modal-title\">\r\n                                        {title}\r\n                                    </h3>\r\n                                    <button\r\n                                        type=\"button\"\r\n                                        onClick={onClose}\r\n                                        className=\"text-gray-400 hover:text-gray-600 transition duration-150 p-1 rounded-full hover:bg-gray-100 focus:outline-none\"\r\n                                    >\r\n                                        <CloseIcon />\r\n                                    </button>\r\n                                </div>\r\n                                <div>\r\n                                    {children}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// MOCK: Datos para selects (Se mantienen como mocks ya que la implementación de su API no se proporcionó)\r\nconst mockMarcas = [\r\n    { id: 'hp', name: 'HP' }, \r\n    { id: 'dell', name: 'Dell' },\r\n    { id: 'lenovo', name: 'Lenovo' }\r\n];\r\nconst mockTiposActivos = [\r\n    { id: 'laptop', name: 'Laptop' }, \r\n    { id: 'desktop', name: 'Desktop' },\r\n    { id: 'tablet', name: 'Tablet' }\r\n];\r\n\r\nconst getMarcas = async () => new Promise(resolve => setTimeout(() => resolve({ data: mockMarcas }), 300));\r\nconst getTiposActivos = async () => new Promise(resolve => setTimeout(() => resolve({ data: mockTiposActivos }), 300));\r\n\r\n// =========================================================================\r\n// FIREBASE IMPLEMENTATION (Reemplazando MOCKS de DB)\r\n// =========================================================================\r\n\r\nconst createModeloComputo = async (payload, userId) => {\r\n    if (!db || !userId) throw new Error(\"Firestore no está inicializado o el usuario no está autenticado.\");\r\n\r\n    // Definimos la ruta para datos privados del usuario (modelos de cómputo)\r\n    const modelosCollectionRef = collection(db, `artifacts/${appId}/users/${userId}/modelos_computo`);\r\n    \r\n    // Añadir el documento a la colección\r\n    const docRef = await addDoc(modelosCollectionRef, payload);\r\n    console.log(\"Modelo creado con ID: \", docRef.id);\r\n    return { id: docRef.id, message: 'Created' };\r\n};\r\n\r\nconst updateModeloComputo = async (id, payload, userId) => {\r\n    if (!db || !userId) throw new Error(\"Firestore no está inicializado o el usuario no está autenticado.\");\r\n    \r\n    // Definimos la referencia al documento específico\r\n    const modeloDocRef = doc(db, `artifacts/${appId}/users/${userId}/modelos_computo`, id);\r\n    \r\n    // Actualizar el documento\r\n    await updateDoc(modeloDocRef, payload);\r\n    console.log(\"Modelo actualizado con ID: \", id);\r\n    return { id, message: 'Updated' };\r\n};\r\n\r\n// =========================================================================\r\n// COMPONENTE PRINCIPAL\r\n// =========================================================================\r\n\r\nconst initialFormData = {\r\n    marca: '',\r\n    tipo_activo: '',\r\n    codigo_interno: '', \r\n    procesador: '',\r\n    ram: '',\r\n    almacenamiento: '',\r\n    tarjeta_grafica: '',\r\n    interfaz_wifi: true,\r\n    mac_wifi: '', \r\n    interfaz_ethernet: true,\r\n    mac_ethernet: '', \r\n    interfaz_serial_paralelo: false,\r\n    serie_cargador: '',\r\n    cuenta_con_docking: false,\r\n    serie_docking: '',\r\n    cuenta_con_pantalla: false,\r\n    serie_pantalla: '',\r\n    cuenta_con_teclado: false,\r\n    serie_teclado: '',\r\n    cuenta_con_mouse: false,\r\n    serie_mouse: '',\r\n    cuenta_con_mochila: false,\r\n};\r\n\r\nconst ModeloComputoFormModal = ({ show, onClose, onSaveSuccess, modeloToEdit }) => {\r\n    const [formData, setFormData] = useState(initialFormData);\r\n    const [marcas, setMarcas] = useState([]);\r\n    const [tiposActivos, setTiposActivos] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n    const [errors, setErrors] = useState({});\r\n    const [userId, setUserId] = useState(null);\r\n    const [isFirestoreReady, setIsFirestoreReady] = useState(false);\r\n\r\n    // 1. Inicialización de Firebase y Autenticación\r\n    useEffect(() => {\r\n        const initFirebase = async () => {\r\n            try {\r\n                const app = initializeApp(firebaseConfig);\r\n                db = getFirestore(app);\r\n                auth = getAuth(app);\r\n                \r\n                if (initialAuthToken) {\r\n                    await signInWithCustomToken(auth, initialAuthToken);\r\n                } else {\r\n                    await signInAnonymously(auth);\r\n                }\r\n                \r\n                const user = auth.currentUser;\r\n                if (user) {\r\n                    setUserId(user.uid);\r\n                    setIsFirestoreReady(true);\r\n                } else {\r\n                    console.error(\"No se pudo obtener el usuario después de la autenticación.\");\r\n                    toast.error(\"Error de autenticación. No se podrá guardar el modelo.\");\r\n                }\r\n\r\n            } catch (error) {\r\n                console.error('Error inicializando Firebase:', error);\r\n                toast.error('Error de conexión con la base de datos.');\r\n            }\r\n        };\r\n        initFirebase();\r\n    }, []);\r\n\r\n    // 2. Carga de dependencias y datos de edición\r\n    useEffect(() => {\r\n        // Cargar datos para selects\r\n        const loadDependencies = async () => {\r\n            try {\r\n                // Aquí usamos los Mocks ya que no se proporcionó la implementación real de estos endpoints\r\n                const [marcasRes, tiposRes] = await Promise.all([getMarcas(), getTiposActivos()]);\r\n                setMarcas(marcasRes.data);\r\n                setTiposActivos(tiposRes.data);\r\n            } catch (error) {\r\n                console.error('Error cargando dependencias:', error);\r\n                toast.error('Error al cargar marcas o tipos de activos.');\r\n            }\r\n        };\r\n        loadDependencies();\r\n\r\n        // Cargar datos para edición si existe modeloToEdit\r\n        if (modeloToEdit) {\r\n            setFormData(prev => ({\r\n                ...initialFormData,\r\n                // Garantiza que todos los campos del modelo se carguen, usando fallback a cadenas vacías para evitar nulls\r\n                ...modeloToEdit,\r\n                mac_wifi: modeloToEdit.mac_wifi || '',\r\n                mac_ethernet: modeloToEdit.mac_ethernet || '',\r\n                // Asegurar que los booleanos se carguen correctamente\r\n                interfaz_wifi: !!modeloToEdit.interfaz_wifi,\r\n                interfaz_ethernet: !!modeloToEdit.interfaz_ethernet,\r\n                cuenta_con_docking: !!modeloToEdit.cuenta_con_docking,\r\n                // ... y el resto de booleanos\r\n            }));\r\n        } else {\r\n            setFormData(initialFormData);\r\n        }\r\n    }, [modeloToEdit]);\r\n\r\n    const handleChange = (e) => {\r\n        const { name, value, type, checked } = e.target;\r\n        const newValue = type === 'checkbox' ? checked : value;\r\n\r\n        setFormData(prev => ({ ...prev, [name]: newValue }));\r\n        setErrors(prev => ({ ...prev, [name]: null }));\r\n    };\r\n\r\n    const handleInterfaceChange = (e, macFieldName) => {\r\n        const { name, checked } = e.target;\r\n        setFormData(prev => ({ \r\n            ...prev, \r\n            [name]: checked,\r\n            // Borra la MAC si se desactiva la interfaz\r\n            [macFieldName]: checked ? prev[macFieldName] : ''\r\n        }));\r\n        if (!checked) {\r\n            setErrors(prev => ({ ...prev, [macFieldName]: null }));\r\n        }\r\n    };\r\n\r\n    const handleAccessoryChange = (e, seriesFieldName) => {\r\n        const { name, checked } = e.target;\r\n        setFormData(prev => ({ \r\n            ...prev, \r\n            [name]: checked, \r\n            // Borra la serie si se desactiva el accesorio\r\n            [seriesFieldName]: checked ? prev[seriesFieldName] : ''\r\n        }));\r\n        if (!checked) {\r\n            setErrors(prev => ({ ...prev, [seriesFieldName]: null }));\r\n        }\r\n    };\r\n\r\n    const validateConditionalFields = (data, newErrors) => {\r\n        // Validación de MACs\r\n        if (data.interfaz_wifi && !data.mac_wifi.trim()) {\r\n            newErrors.mac_wifi = 'La MAC Wi-Fi es obligatoria si la interfaz está marcada.';\r\n        }\r\n        if (data.interfaz_ethernet && !data.mac_ethernet.trim()) {\r\n            newErrors.mac_ethernet = 'La MAC Ethernet es obligatoria si la interfaz está marcada.';\r\n        }\r\n        \r\n        // Validación de Series de Accesorios\r\n        if (data.cuenta_con_docking && !data.serie_docking.trim()) {\r\n            newErrors.serie_docking = 'La serie de docking es obligatoria si cuenta con docking.';\r\n        }\r\n        if (data.cuenta_con_pantalla && !data.serie_pantalla.trim()) {\r\n            newErrors.serie_pantalla = 'La serie de pantalla es obligatoria si cuenta con pantalla.';\r\n        }\r\n        if (data.cuenta_con_teclado && !data.serie_teclado.trim()) {\r\n            newErrors.serie_teclado = 'La serie de teclado es obligatoria si cuenta con teclado.';\r\n        }\r\n        if (data.cuenta_con_mouse && !data.serie_mouse.trim()) {\r\n            newErrors.serie_mouse = 'La serie de mouse es obligatoria si cuenta con mouse.';\r\n        }\r\n    };\r\n\r\n    const validate = (data) => {\r\n        const newErrors = {};\r\n        // Campos obligatorios\r\n        if (!data.marca.trim()) newErrors.marca = 'La marca es obligatoria.';\r\n        if (!data.tipo_activo.trim()) newErrors.tipo_activo = 'El tipo de activo es obligatorio.';\r\n        if (!data.codigo_interno.trim()) newErrors.codigo_interno = 'El Nombre del Modelo es obligatorio.'; \r\n        if (!data.procesador.trim()) newErrors.procesador = 'El procesador es obligatorio.';\r\n        if (!data.ram.trim()) newErrors.ram = 'La RAM es obligatoria.';\r\n        if (!data.almacenamiento.trim()) newErrors.almacenamiento = 'El almacenamiento es obligatorio.';\r\n        \r\n        validateConditionalFields(data, newErrors);\r\n        \r\n        return newErrors;\r\n    };\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        \r\n        if (!isFirestoreReady || !userId) {\r\n            toast.error('La conexión con la base de datos aún no está lista. Por favor, espera un momento.');\r\n            console.error('Firestore not ready. isFirestoreReady:', isFirestoreReady, 'userId:', userId);\r\n            return;\r\n        }\r\n\r\n        const findErrors = validate(formData);\r\n        \r\n        if (Object.keys(findErrors).length > 0) {\r\n            setErrors(findErrors);\r\n            toast.error('Por favor, corrige los errores del formulario.');\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        try {\r\n            // El objeto payload para enviar a Firestore\r\n            const payload = { ...formData };\r\n            \r\n            // Limpiar valores vacíos para que Firestore no guarde series inhabilitadas con '' (opcional)\r\n            if (!payload.interfaz_wifi) delete payload.mac_wifi;\r\n            if (!payload.interfaz_ethernet) delete payload.mac_ethernet;\r\n            if (!payload.cuenta_con_docking) delete payload.serie_docking;\r\n            if (!payload.cuenta_con_pantalla) delete payload.serie_pantalla;\r\n            if (!payload.cuenta_con_teclado) delete payload.serie_teclado;\r\n            if (!payload.cuenta_con_mouse) delete payload.serie_mouse;\r\n\r\n\r\n            if (modeloToEdit) {\r\n                // Llamada REAL a la función de UPDATE con userId\r\n                await updateModeloComputo(modeloToEdit.id, payload, userId);\r\n                toast.success('Modelo de cómputo actualizado exitosamente!');\r\n            } else {\r\n                // Llamada REAL a la función de CREATE con userId\r\n                await createModeloComputo(payload, userId);\r\n                toast.success('Modelo de cómputo creado exitosamente!');\r\n            }\r\n            onSaveSuccess();\r\n            onClose();\r\n        } catch (error) {\r\n            console.error('Error saving modelo:', error.message);\r\n            // Mostrar un error genérico de la DB\r\n            toast.error('Error al guardar el modelo de cómputo. Revisa la consola para más detalles.');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const getInputClasses = (name, isSeriesField, isDisabled, isSelect) => {\r\n        let classes = `mt-1 block w-full rounded-lg border-2 p-2 shadow-sm transition duration-150 ease-in-out `;\r\n        \r\n        classes += `border-gray-400 focus:border-indigo-600 focus:ring-2 focus:ring-indigo-300 `;\r\n\r\n        if (isDisabled) {\r\n            classes += `bg-gray-100 cursor-not-allowed text-gray-500 `;\r\n        } else {\r\n            classes += `bg-white text-gray-800 `;\r\n        }\r\n        \r\n        if (errors[name]) {\r\n            classes += `!border-red-500 `;\r\n        }\r\n\r\n        if (isSelect) {\r\n            classes += `appearance-none pr-8 `;\r\n        }\r\n\r\n        return classes.trim();\r\n    };\r\n    \r\n    const renderInput = (label, name, type = 'text', required = true, isConditional = false, seriesOrMacFieldName = null) => {\r\n        const isCheckbox = type === 'checkbox';\r\n        const isSelect = type === 'select';\r\n        \r\n        const isSeriesField = name.startsWith('serie_');\r\n        let isDisabled = false;\r\n\r\n        // LÓGICA DE DESHABILITACIÓN MEJORADA: \r\n        if (name === 'mac_wifi') {\r\n            isDisabled = !formData.interfaz_wifi;\r\n        } else if (name === 'mac_ethernet') {\r\n            isDisabled = !formData.interfaz_ethernet;\r\n        } else if (isSeriesField && name !== 'serie_cargador') { \r\n            const controlField = name.replace('serie_', 'cuenta_con_');\r\n            isDisabled = !formData[controlField];\r\n        } \r\n        \r\n        const handleSpecificChange = (e) => {\r\n            if (name === 'interfaz_wifi') {\r\n                handleInterfaceChange(e, 'mac_wifi');\r\n            } else if (name === 'interfaz_ethernet') {\r\n                handleInterfaceChange(e, 'mac_ethernet');\r\n            } else if (isConditional) {\r\n                // Para checkboxes de accesorios (cuenta_con_X)\r\n                handleAccessoryChange(e, seriesOrMacFieldName);\r\n            } else {\r\n                // Para todos los demás campos (text, select, checkbox simple)\r\n                handleChange(e);\r\n            }\r\n        };\r\n\r\n        const isMacRequired = (name === 'mac_wifi' && formData.interfaz_wifi) || (name === 'mac_ethernet' && formData.interfaz_ethernet);\r\n        // La validación `validate` se encarga de esto, pero mantenemos el asterisco\r\n        const finalRequired = required || isMacRequired || (isSeriesField && formData[name.replace('serie_', 'cuenta_con_')]); \r\n\r\n        return (\r\n            <div key={name} className=\"relative\">\r\n                <label className=\"block text-sm font-semibold text-gray-700\">\r\n                    {label} {(required || isMacRequired) && <span className=\"text-red-500\">*</span>}\r\n                </label>\r\n                \r\n                {isSelect ? (\r\n                    <select\r\n                        name={name}\r\n                        value={formData[name] || ''}\r\n                        onChange={handleChange}\r\n                        className={getInputClasses(name, false, false, true)}\r\n                    >\r\n                        <option value=\"\">Seleccione...</option>\r\n                        {(name === 'marca' ? marcas : tiposActivos).map(item => (\r\n                            <option key={item.id} value={item.id}>{item.name}</option>\r\n                        ))}\r\n                    </select>\r\n                ) : isCheckbox ? (\r\n                    <div className=\"flex items-center h-full pt-1\">\r\n                        <input\r\n                            type=\"checkbox\"\r\n                            name={name}\r\n                            checked={formData[name]}\r\n                            onChange={handleSpecificChange}\r\n                            className=\"h-5 w-5 text-indigo-600 border-gray-400 rounded focus:ring-indigo-500\"\r\n                        />\r\n                    </div>\r\n                ) : (\r\n                    <input\r\n                        type={type}\r\n                        name={name}\r\n                        value={formData[name] || ''}\r\n                        onChange={handleChange}\r\n                        className={getInputClasses(name, isSeriesField, isDisabled, false)}\r\n                        disabled={isDisabled}\r\n                        placeholder={isDisabled ? 'N/A' : (name.startsWith('mac_') ? 'Ej: AA:BB:CC:DD:EE:FF' : '')}\r\n                    />\r\n                )}\r\n                \r\n                {errors[name] && <p className=\"mt-1 text-xs text-red-600 font-medium\">{errors[name]}</p>}\r\n            </div>\r\n        );\r\n    };\r\n\r\n\r\n    return (\r\n        <Modal \r\n            show={show} \r\n            onClose={onClose} \r\n            title={modeloToEdit ? \"Editar Modelo de Cómputo\" : \"Crear Modelo de Cómputo\"}\r\n        >\r\n            <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n                {/* GRID DE 2 COLUMNAS */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                    \r\n                    {/* BLOQUE DE IDENTIFICACIÓN Y RELACIONES */}\r\n                    {renderInput('Nombre Modelo', 'codigo_interno')}\r\n                    {renderInput('Marca', 'marca', 'select')}\r\n                    {renderInput('Tipo de Activo', 'tipo_activo', 'select')}\r\n                    <div className=\"h-0 invisible\"></div> {/* Espacio vacío para mantener el layout */}\r\n\r\n                    {/* SECCIÓN DE ESPECIFICACIONES DE HARDWARE */}\r\n                    <div className=\"col-span-1 md:col-span-2 border-t pt-4\">\r\n                        <h3 className=\"text-lg font-bold text-gray-800 mb-2\">Especificaciones de Hardware</h3>\r\n                    </div>\r\n                    \r\n                    {renderInput('Procesador', 'procesador')}\r\n                    {renderInput('Tarjeta Gráfica', 'tarjeta_grafica', 'text', false)}\r\n                    \r\n                    {renderInput('RAM (Ej: 16GB)', 'ram')} \r\n                    {renderInput('Almacenamiento (Ej: 512GB SSD)', 'almacenamiento')}\r\n\r\n\r\n                    {/* SECCIÓN DE INTERFACES Y MAC ADDRESS */}\r\n                    <div className=\"col-span-1 md:col-span-2 border-t pt-4\">\r\n                        <h3 className=\"text-lg font-bold text-gray-800 mb-2\">Interfaces de Red y Dirección MAC</h3>\r\n                    </div>\r\n                    \r\n                    {/* MAC Wi-Fi (Checkbox y campo de texto condicional) */}\r\n                    <div className=\"p-3 border rounded-xl shadow-inner bg-indigo-50/70\">\r\n                        {renderInput('Incluye Interfaz WiFi', 'interfaz_wifi', 'checkbox', false, true, 'mac_wifi')}\r\n                        {renderInput('MAC Address Wi-Fi', 'mac_wifi', 'text', false)} \r\n                    </div>\r\n\r\n                    {/* MAC Ethernet (Checkbox y campo de texto condicional) */}\r\n                    <div className=\"p-3 border rounded-xl shadow-inner bg-indigo-50/70\">\r\n                        {renderInput('Incluye Interfaz Ethernet', 'interfaz_ethernet', 'checkbox', false, true, 'mac_ethernet')}\r\n                        {renderInput('MAC Address Ethernet', 'mac_ethernet', 'text', false)}\r\n                    </div>\r\n                    \r\n                    {/* Otras interfaces */}\r\n                    <div className=\"col-span-1 md:col-span-2 pt-2\">\r\n                        {renderInput('Interfaz Serial/Paralelo', 'interfaz_serial_paralelo', 'checkbox', false)}\r\n                    </div>\r\n                    \r\n                    {/* SECCIÓN DE ACCESORIOS */}\r\n                    <div className=\"col-span-1 md:col-span-2 border-t pt-4\">\r\n                        <h3 className=\"text-lg font-bold text-gray-800 mb-2\">Accesorios y Series</h3>\r\n                    </div>\r\n\r\n                    {/* Layout interno para accesorios en 2 columnas */}\r\n                    <div className=\"col-span-1 md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                        \r\n                        {/* SERIE CARGADOR AHORA SIEMPRE HABILITADO Y NO OBLIGATORIO */}\r\n                        {renderInput('Serie de Cargador', 'serie_cargador', 'text', false)}\r\n                        <div className='flex items-end'>{renderInput('Cuenta con Mochila', 'cuenta_con_mochila', 'checkbox', false)}</div>\r\n\r\n                        <div className=\"p-3 border rounded-xl shadow-inner bg-yellow-50/50\">\r\n                            {renderInput('Cuenta con Docking', 'cuenta_con_docking', 'checkbox', false, true, 'serie_docking')}\r\n                            {renderInput('Serie de Docking', 'serie_docking', 'text', false, false)}\r\n                        </div>\r\n                        <div className=\"p-3 border rounded-xl shadow-inner bg-yellow-50/50\">\r\n                            {renderInput('Cuenta con Pantalla', 'cuenta_con_pantalla', 'checkbox', false, true, 'serie_pantalla')}\r\n                            {renderInput('Serie de Pantalla', 'serie_pantalla', 'text', false, false)}\r\n                        </div>\r\n\r\n                        <div className=\"p-3 border rounded-xl shadow-inner bg-yellow-50/50\">\r\n                            {renderInput('Cuenta con Teclado', 'cuenta_con_teclado', 'checkbox', false, true, 'serie_teclado')}\r\n                            {renderInput('Serie de Teclado', 'serie_teclado', 'text', false, false)}\r\n                        </div>\r\n                        <div className=\"p-3 border rounded-xl shadow-inner bg-yellow-50/50\">\r\n                            {renderInput('Cuenta con Mouse', 'cuenta_con_mouse', 'checkbox', false, true, 'serie_mouse')}\r\n                            {renderInput('Serie de Mouse', 'serie_mouse', 'text', false, false)}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                \r\n                {/* Footer de botones de acción */}\r\n                <div className=\"flex justify-end space-x-3 border-t pt-6 mt-8\">\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={onClose}\r\n                        className=\"px-6 py-2 text-sm font-semibold text-gray-700 bg-white border border-gray-300 rounded-xl shadow-md hover:bg-gray-100 transition duration-150\"\r\n                        disabled={loading}\r\n                    >\r\n                        Cancelar\r\n                    </button>\r\n                    <button\r\n                        type=\"submit\"\r\n                        className=\"px-6 py-2 text-sm font-semibold text-white bg-indigo-600 rounded-xl shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-300 transition duration-150\"\r\n                        disabled={loading || !isFirestoreReady}\r\n                    >\r\n                        {loading ? 'Guardando...' : 'Guardar Modelo'}\r\n                    </button>\r\n                </div>\r\n            </form>\r\n        </Modal>\r\n    );\r\n};\r\n\r\n// Componente Wrapper para simular el uso en el entorno principal\r\n// Este componente de prueba solo sirve para que el Formulario sea visible y funcional\r\nconst App = () => {\r\n    const [showModal, setShowModal] = useState(false);\r\n    \r\n    // Función de MOCK para el toast\r\n    if (typeof toast === 'undefined') {\r\n        window.toast = {\r\n            success: (msg) => console.log('SUCCESS:', msg),\r\n            error: (msg) => console.error('ERROR:', msg)\r\n        };\r\n    }\r\n    \r\n    // MOCK para manejar el éxito del guardado\r\n    const handleSaveSuccess = () => {\r\n        console.log(\"Modelo guardado exitosamente. Actualizar la tabla de modelos aquí.\");\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-8 bg-gray-50 min-h-screen\">\r\n            <h1 className=\"text-3xl font-extrabold text-gray-900 mb-8\">\r\n                Prueba del Formulario de Modelo de Cómputo\r\n            </h1>\r\n            <button\r\n                onClick={() => setShowModal(true)}\r\n                className=\"px-4 py-2 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 transition\"\r\n            >\r\n                Abrir Formulario\r\n            </button>\r\n\r\n            <ModeloComputoFormModal \r\n                show={showModal} \r\n                onClose={() => setShowModal(false)} \r\n                onSaveSuccess={handleSaveSuccess}\r\n                modeloToEdit={null} // Pasa un objeto si quieres probar la edición\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default App;\r\n"],"mappings":";;;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD;AACA;AACA,SAASC,KAAK,QAAQ,gBAAgB;AACtC,SAASC,aAAa,QAAQ,cAAc;AAC5C,SAASC,OAAO,EAAEC,iBAAiB,EAAEC,qBAAqB,QAAQ,eAAe;AACjF,SACIC,YAAY,EACZC,GAAG,EACHC,UAAU,EACVC,MAAM,EACNC;AACA;AAAA,OACG,oBAAoB;;AAE3B;AACA;AACA;;AAEA;AAAA,SAAAC,MAAA,IAAAC,OAAA;AACA,MAAMC,KAAK,GAAG,OAAOC,QAAQ,KAAK,WAAW,GAAGA,QAAQ,GAAG,gBAAgB;AAC3E,MAAMC,cAAc,GAAG,OAAOC,iBAAiB,KAAK,WAAW,GAAGC,IAAI,CAACC,KAAK,CAACF,iBAAiB,CAAC,GAAG,CAAC,CAAC;AACpG,MAAMG,gBAAgB,GAAG,OAAOC,oBAAoB,KAAK,WAAW,GAAGA,oBAAoB,GAAG,IAAI;AAElG,IAAIC,EAAE,GAAG,IAAI;AACb,IAAIC,IAAI,GAAG,IAAI;;AAEf;AACA;AACA;;AAEA;AACA,MAAMC,SAAS,GAAGA,CAAA,kBACdX,OAAA;EAAKY,KAAK,EAAC,4BAA4B;EAACC,IAAI,EAAC,MAAM;EAACC,OAAO,EAAC,WAAW;EAACC,WAAW,EAAE,GAAI;EAACC,MAAM,EAAC,cAAc;EAACC,SAAS,EAAC,SAAS;EAAAC,QAAA,eAC/HlB,OAAA;IAAMmB,aAAa,EAAC,OAAO;IAACC,cAAc,EAAC,OAAO;IAACC,CAAC,EAAC;EAAsB;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE;AAAC;EAAAH,QAAA,EAAAC,YAAA;EAAAC,UAAA;EAAAC,YAAA;AAAA,OAC7E,CACR;;AAED;AAAAC,EAAA,GANMf,SAAS;AAOf,MAAMgB,KAAK,GAAGA,CAAC;EAAEC,IAAI;EAAEC,OAAO;EAAEC,KAAK;EAAEZ;AAAS,CAAC,KAAK;EAClD,IAAI,CAACU,IAAI,EAAE,OAAO,IAAI;;EAEtB;EACA,MAAMG,mBAAmB,GAAIC,CAAC,IAAK;IAC/B,IAAIA,CAAC,CAACC,MAAM,CAACC,EAAE,KAAK,gBAAgB,EAAE;MAClCL,OAAO,CAAC,CAAC;IACb;EACJ,CAAC;EAED,oBACI7B,OAAA;IACIkC,EAAE,EAAC,gBAAgB;IACnBjB,SAAS,EAAC,iFAAiF;IAC3F,mBAAgB,aAAa;IAC7BkB,IAAI,EAAC,QAAQ;IACb,cAAW,MAAM;IACjBC,OAAO,EAAEL,mBAAoB;IAAAb,QAAA,eAE7BlB,OAAA;MAAKiB,SAAS,EAAC,wFAAwF;MAAAC,QAAA,gBACnGlB,OAAA;QAAKiB,SAAS,EAAC,kCAAkC;QAAC,eAAY;MAAM;QAAAK,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC,eAC3EzB,OAAA;QAAMiB,SAAS,EAAC,oDAAoD;QAAC,eAAY,MAAM;QAAAC,QAAA,EAAC;MAAO;QAAAI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC,eAEtGzB,OAAA;QAAKiB,SAAS,EAAC,4JAA4J;QAAAC,QAAA,eACvKlB,OAAA;UAAKiB,SAAS,EAAC,wCAAwC;UAAAC,QAAA,eACnDlB,OAAA;YAAKiB,SAAS,EAAC,wBAAwB;YAAAC,QAAA,eACnClB,OAAA;cAAKiB,SAAS,EAAC,8CAA8C;cAAAC,QAAA,gBAEzDlB,OAAA;gBAAKiB,SAAS,EAAC,sDAAsD;gBAAAC,QAAA,gBACjElB,OAAA;kBAAIiB,SAAS,EAAC,gDAAgD;kBAACiB,EAAE,EAAC,aAAa;kBAAAhB,QAAA,EAC1EY;gBAAK;kBAAAR,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACN,CAAC,eACLzB,OAAA;kBACIqC,IAAI,EAAC,QAAQ;kBACbD,OAAO,EAAEP,OAAQ;kBACjBZ,SAAS,EAAC,iHAAiH;kBAAAC,QAAA,eAE3HlB,OAAA,CAACW,SAAS;oBAAAW,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACT,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACR,CAAC,eACNzB,OAAA;gBAAAkB,QAAA,EACKA;cAAQ;gBAAAI,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACR,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACL;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACL;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACL;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACL,CAAC;AAEd,CAAC;;AAED;AAAAa,GAAA,GApDMX,KAAK;AAqDX,MAAMY,UAAU,GAAG,CACf;EAAEL,EAAE,EAAE,IAAI;EAAEM,IAAI,EAAE;AAAK,CAAC,EACxB;EAAEN,EAAE,EAAE,MAAM;EAAEM,IAAI,EAAE;AAAO,CAAC,EAC5B;EAAEN,EAAE,EAAE,QAAQ;EAAEM,IAAI,EAAE;AAAS,CAAC,CACnC;AACD,MAAMC,gBAAgB,GAAG,CACrB;EAAEP,EAAE,EAAE,QAAQ;EAAEM,IAAI,EAAE;AAAS,CAAC,EAChC;EAAEN,EAAE,EAAE,SAAS;EAAEM,IAAI,EAAE;AAAU,CAAC,EAClC;EAAEN,EAAE,EAAE,QAAQ;EAAEM,IAAI,EAAE;AAAS,CAAC,CACnC;AAED,MAAME,SAAS,GAAG,MAAAA,CAAA,KAAY,IAAIC,OAAO,CAACC,OAAO,IAAIC,UAAU,CAAC,MAAMD,OAAO,CAAC;EAAEE,IAAI,EAAEP;AAAW,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC;AAC1G,MAAMQ,eAAe,GAAG,MAAAA,CAAA,KAAY,IAAIJ,OAAO,CAACC,OAAO,IAAIC,UAAU,CAAC,MAAMD,OAAO,CAAC;EAAEE,IAAI,EAAEL;AAAiB,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC;;AAEtH;AACA;AACA;;AAEA,MAAMO,mBAAmB,GAAG,MAAAA,CAAOC,OAAO,EAAEC,MAAM,KAAK;EACnD,IAAI,CAACzC,EAAE,IAAI,CAACyC,MAAM,EAAE,MAAM,IAAIC,KAAK,CAAC,kEAAkE,CAAC;;EAEvG;EACA,MAAMC,oBAAoB,GAAGxD,UAAU,CAACa,EAAE,EAAE,aAAaR,KAAK,UAAUiD,MAAM,kBAAkB,CAAC;;EAEjG;EACA,MAAMG,MAAM,GAAG,MAAMxD,MAAM,CAACuD,oBAAoB,EAAEH,OAAO,CAAC;EAC1DK,OAAO,CAACC,GAAG,CAAC,wBAAwB,EAAEF,MAAM,CAACnB,EAAE,CAAC;EAChD,OAAO;IAAEA,EAAE,EAAEmB,MAAM,CAACnB,EAAE;IAAEsB,OAAO,EAAE;EAAU,CAAC;AAChD,CAAC;AAED,MAAMC,mBAAmB,GAAG,MAAAA,CAAOvB,EAAE,EAAEe,OAAO,EAAEC,MAAM,KAAK;EACvD,IAAI,CAACzC,EAAE,IAAI,CAACyC,MAAM,EAAE,MAAM,IAAIC,KAAK,CAAC,kEAAkE,CAAC;;EAEvG;EACA,MAAMO,YAAY,GAAG/D,GAAG,CAACc,EAAE,EAAE,aAAaR,KAAK,UAAUiD,MAAM,kBAAkB,EAAEhB,EAAE,CAAC;;EAEtF;EACA,MAAMyB,SAAS,CAACD,YAAY,EAAET,OAAO,CAAC;EACtCK,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAErB,EAAE,CAAC;EAC9C,OAAO;IAAEA,EAAE;IAAEsB,OAAO,EAAE;EAAU,CAAC;AACrC,CAAC;;AAED;AACA;AACA;;AAEA,MAAMI,eAAe,GAAG;EACpBC,KAAK,EAAE,EAAE;EACTC,WAAW,EAAE,EAAE;EACfC,cAAc,EAAE,EAAE;EAClBC,UAAU,EAAE,EAAE;EACdC,GAAG,EAAE,EAAE;EACPC,cAAc,EAAE,EAAE;EAClBC,eAAe,EAAE,EAAE;EACnBC,aAAa,EAAE,IAAI;EACnBC,QAAQ,EAAE,EAAE;EACZC,iBAAiB,EAAE,IAAI;EACvBC,YAAY,EAAE,EAAE;EAChBC,wBAAwB,EAAE,KAAK;EAC/BC,cAAc,EAAE,EAAE;EAClBC,kBAAkB,EAAE,KAAK;EACzBC,aAAa,EAAE,EAAE;EACjBC,mBAAmB,EAAE,KAAK;EAC1BC,cAAc,EAAE,EAAE;EAClBC,kBAAkB,EAAE,KAAK;EACzBC,aAAa,EAAE,EAAE;EACjBC,gBAAgB,EAAE,KAAK;EACvBC,WAAW,EAAE,EAAE;EACfC,kBAAkB,EAAE;AACxB,CAAC;AAED,MAAMC,sBAAsB,GAAGA,CAAC;EAAEvD,IAAI;EAAEC,OAAO;EAAEuD,aAAa;EAAEC;AAAa,CAAC,KAAK;EAAAC,EAAA;EAC/E,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGrG,QAAQ,CAACyE,eAAe,CAAC;EACzD,MAAM,CAAC6B,MAAM,EAAEC,SAAS,CAAC,GAAGvG,QAAQ,CAAC,EAAE,CAAC;EACxC,MAAM,CAACwG,YAAY,EAAEC,eAAe,CAAC,GAAGzG,QAAQ,CAAC,EAAE,CAAC;EACpD,MAAM,CAAC0G,OAAO,EAAEC,UAAU,CAAC,GAAG3G,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAAC4G,MAAM,EAAEC,SAAS,CAAC,GAAG7G,QAAQ,CAAC,CAAC,CAAC,CAAC;EACxC,MAAM,CAAC+D,MAAM,EAAE+C,SAAS,CAAC,GAAG9G,QAAQ,CAAC,IAAI,CAAC;EAC1C,MAAM,CAAC+G,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGhH,QAAQ,CAAC,KAAK,CAAC;;EAE/D;EACAC,SAAS,CAAC,MAAM;IACZ,MAAMgH,YAAY,GAAG,MAAAA,CAAA,KAAY;MAC7B,IAAI;QACA,MAAMC,GAAG,GAAG/G,aAAa,CAACa,cAAc,CAAC;QACzCM,EAAE,GAAGf,YAAY,CAAC2G,GAAG,CAAC;QACtB3F,IAAI,GAAGnB,OAAO,CAAC8G,GAAG,CAAC;QAEnB,IAAI9F,gBAAgB,EAAE;UAClB,MAAMd,qBAAqB,CAACiB,IAAI,EAAEH,gBAAgB,CAAC;QACvD,CAAC,MAAM;UACH,MAAMf,iBAAiB,CAACkB,IAAI,CAAC;QACjC;QAEA,MAAM4F,IAAI,GAAG5F,IAAI,CAAC6F,WAAW;QAC7B,IAAID,IAAI,EAAE;UACNL,SAAS,CAACK,IAAI,CAACE,GAAG,CAAC;UACnBL,mBAAmB,CAAC,IAAI,CAAC;QAC7B,CAAC,MAAM;UACH7C,OAAO,CAACmD,KAAK,CAAC,4DAA4D,CAAC;UAC3EpH,KAAK,CAACoH,KAAK,CAAC,wDAAwD,CAAC;QACzE;MAEJ,CAAC,CAAC,OAAOA,KAAK,EAAE;QACZnD,OAAO,CAACmD,KAAK,CAAC,+BAA+B,EAAEA,KAAK,CAAC;QACrDpH,KAAK,CAACoH,KAAK,CAAC,yCAAyC,CAAC;MAC1D;IACJ,CAAC;IACDL,YAAY,CAAC,CAAC;EAClB,CAAC,EAAE,EAAE,CAAC;;EAEN;EACAhH,SAAS,CAAC,MAAM;IACZ;IACA,MAAMsH,gBAAgB,GAAG,MAAAA,CAAA,KAAY;MACjC,IAAI;QACA;QACA,MAAM,CAACC,SAAS,EAAEC,QAAQ,CAAC,GAAG,MAAMjE,OAAO,CAACkE,GAAG,CAAC,CAACnE,SAAS,CAAC,CAAC,EAAEK,eAAe,CAAC,CAAC,CAAC,CAAC;QACjF2C,SAAS,CAACiB,SAAS,CAAC7D,IAAI,CAAC;QACzB8C,eAAe,CAACgB,QAAQ,CAAC9D,IAAI,CAAC;MAClC,CAAC,CAAC,OAAO2D,KAAK,EAAE;QACZnD,OAAO,CAACmD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;QACpDpH,KAAK,CAACoH,KAAK,CAAC,4CAA4C,CAAC;MAC7D;IACJ,CAAC;IACDC,gBAAgB,CAAC,CAAC;;IAElB;IACA,IAAIrB,YAAY,EAAE;MACdG,WAAW,CAACsB,IAAI,KAAK;QACjB,GAAGlD,eAAe;QAClB;QACA,GAAGyB,YAAY;QACfhB,QAAQ,EAAEgB,YAAY,CAAChB,QAAQ,IAAI,EAAE;QACrCE,YAAY,EAAEc,YAAY,CAACd,YAAY,IAAI,EAAE;QAC7C;QACAH,aAAa,EAAE,CAAC,CAACiB,YAAY,CAACjB,aAAa;QAC3CE,iBAAiB,EAAE,CAAC,CAACe,YAAY,CAACf,iBAAiB;QACnDI,kBAAkB,EAAE,CAAC,CAACW,YAAY,CAACX;QACnC;MACJ,CAAC,CAAC,CAAC;IACP,CAAC,MAAM;MACHc,WAAW,CAAC5B,eAAe,CAAC;IAChC;EACJ,CAAC,EAAE,CAACyB,YAAY,CAAC,CAAC;EAElB,MAAM0B,YAAY,GAAI/E,CAAC,IAAK;IACxB,MAAM;MAAEQ,IAAI;MAAEwE,KAAK;MAAE3E,IAAI;MAAE4E;IAAQ,CAAC,GAAGjF,CAAC,CAACC,MAAM;IAC/C,MAAMiF,QAAQ,GAAG7E,IAAI,KAAK,UAAU,GAAG4E,OAAO,GAAGD,KAAK;IAEtDxB,WAAW,CAACsB,IAAI,KAAK;MAAE,GAAGA,IAAI;MAAE,CAACtE,IAAI,GAAG0E;IAAS,CAAC,CAAC,CAAC;IACpDlB,SAAS,CAACc,IAAI,KAAK;MAAE,GAAGA,IAAI;MAAE,CAACtE,IAAI,GAAG;IAAK,CAAC,CAAC,CAAC;EAClD,CAAC;EAED,MAAM2E,qBAAqB,GAAGA,CAACnF,CAAC,EAAEoF,YAAY,KAAK;IAC/C,MAAM;MAAE5E,IAAI;MAAEyE;IAAQ,CAAC,GAAGjF,CAAC,CAACC,MAAM;IAClCuD,WAAW,CAACsB,IAAI,KAAK;MACjB,GAAGA,IAAI;MACP,CAACtE,IAAI,GAAGyE,OAAO;MACf;MACA,CAACG,YAAY,GAAGH,OAAO,GAAGH,IAAI,CAACM,YAAY,CAAC,GAAG;IACnD,CAAC,CAAC,CAAC;IACH,IAAI,CAACH,OAAO,EAAE;MACVjB,SAAS,CAACc,IAAI,KAAK;QAAE,GAAGA,IAAI;QAAE,CAACM,YAAY,GAAG;MAAK,CAAC,CAAC,CAAC;IAC1D;EACJ,CAAC;EAED,MAAMC,qBAAqB,GAAGA,CAACrF,CAAC,EAAEsF,eAAe,KAAK;IAClD,MAAM;MAAE9E,IAAI;MAAEyE;IAAQ,CAAC,GAAGjF,CAAC,CAACC,MAAM;IAClCuD,WAAW,CAACsB,IAAI,KAAK;MACjB,GAAGA,IAAI;MACP,CAACtE,IAAI,GAAGyE,OAAO;MACf;MACA,CAACK,eAAe,GAAGL,OAAO,GAAGH,IAAI,CAACQ,eAAe,CAAC,GAAG;IACzD,CAAC,CAAC,CAAC;IACH,IAAI,CAACL,OAAO,EAAE;MACVjB,SAAS,CAACc,IAAI,KAAK;QAAE,GAAGA,IAAI;QAAE,CAACQ,eAAe,GAAG;MAAK,CAAC,CAAC,CAAC;IAC7D;EACJ,CAAC;EAED,MAAMC,yBAAyB,GAAGA,CAACzE,IAAI,EAAE0E,SAAS,KAAK;IACnD;IACA,IAAI1E,IAAI,CAACsB,aAAa,IAAI,CAACtB,IAAI,CAACuB,QAAQ,CAACoD,IAAI,CAAC,CAAC,EAAE;MAC7CD,SAAS,CAACnD,QAAQ,GAAG,0DAA0D;IACnF;IACA,IAAIvB,IAAI,CAACwB,iBAAiB,IAAI,CAACxB,IAAI,CAACyB,YAAY,CAACkD,IAAI,CAAC,CAAC,EAAE;MACrDD,SAAS,CAACjD,YAAY,GAAG,6DAA6D;IAC1F;;IAEA;IACA,IAAIzB,IAAI,CAAC4B,kBAAkB,IAAI,CAAC5B,IAAI,CAAC6B,aAAa,CAAC8C,IAAI,CAAC,CAAC,EAAE;MACvDD,SAAS,CAAC7C,aAAa,GAAG,2DAA2D;IACzF;IACA,IAAI7B,IAAI,CAAC8B,mBAAmB,IAAI,CAAC9B,IAAI,CAAC+B,cAAc,CAAC4C,IAAI,CAAC,CAAC,EAAE;MACzDD,SAAS,CAAC3C,cAAc,GAAG,6DAA6D;IAC5F;IACA,IAAI/B,IAAI,CAACgC,kBAAkB,IAAI,CAAChC,IAAI,CAACiC,aAAa,CAAC0C,IAAI,CAAC,CAAC,EAAE;MACvDD,SAAS,CAACzC,aAAa,GAAG,2DAA2D;IACzF;IACA,IAAIjC,IAAI,CAACkC,gBAAgB,IAAI,CAAClC,IAAI,CAACmC,WAAW,CAACwC,IAAI,CAAC,CAAC,EAAE;MACnDD,SAAS,CAACvC,WAAW,GAAG,uDAAuD;IACnF;EACJ,CAAC;EAED,MAAMyC,QAAQ,GAAI5E,IAAI,IAAK;IACvB,MAAM0E,SAAS,GAAG,CAAC,CAAC;IACpB;IACA,IAAI,CAAC1E,IAAI,CAACe,KAAK,CAAC4D,IAAI,CAAC,CAAC,EAAED,SAAS,CAAC3D,KAAK,GAAG,0BAA0B;IACpE,IAAI,CAACf,IAAI,CAACgB,WAAW,CAAC2D,IAAI,CAAC,CAAC,EAAED,SAAS,CAAC1D,WAAW,GAAG,mCAAmC;IACzF,IAAI,CAAChB,IAAI,CAACiB,cAAc,CAAC0D,IAAI,CAAC,CAAC,EAAED,SAAS,CAACzD,cAAc,GAAG,sCAAsC;IAClG,IAAI,CAACjB,IAAI,CAACkB,UAAU,CAACyD,IAAI,CAAC,CAAC,EAAED,SAAS,CAACxD,UAAU,GAAG,+BAA+B;IACnF,IAAI,CAAClB,IAAI,CAACmB,GAAG,CAACwD,IAAI,CAAC,CAAC,EAAED,SAAS,CAACvD,GAAG,GAAG,wBAAwB;IAC9D,IAAI,CAACnB,IAAI,CAACoB,cAAc,CAACuD,IAAI,CAAC,CAAC,EAAED,SAAS,CAACtD,cAAc,GAAG,mCAAmC;IAE/FqD,yBAAyB,CAACzE,IAAI,EAAE0E,SAAS,CAAC;IAE1C,OAAOA,SAAS;EACpB,CAAC;EAED,MAAMG,YAAY,GAAG,MAAO3F,CAAC,IAAK;IAC9BA,CAAC,CAAC4F,cAAc,CAAC,CAAC;IAElB,IAAI,CAAC1B,gBAAgB,IAAI,CAAChD,MAAM,EAAE;MAC9B7D,KAAK,CAACoH,KAAK,CAAC,mFAAmF,CAAC;MAChGnD,OAAO,CAACmD,KAAK,CAAC,wCAAwC,EAAEP,gBAAgB,EAAE,SAAS,EAAEhD,MAAM,CAAC;MAC5F;IACJ;IAEA,MAAM2E,UAAU,GAAGH,QAAQ,CAACnC,QAAQ,CAAC;IAErC,IAAIuC,MAAM,CAACC,IAAI,CAACF,UAAU,CAAC,CAACG,MAAM,GAAG,CAAC,EAAE;MACpChC,SAAS,CAAC6B,UAAU,CAAC;MACrBxI,KAAK,CAACoH,KAAK,CAAC,gDAAgD,CAAC;MAC7D;IACJ;IAEAX,UAAU,CAAC,IAAI,CAAC;IAChB,IAAI;MACA;MACA,MAAM7C,OAAO,GAAG;QAAE,GAAGsC;MAAS,CAAC;;MAE/B;MACA,IAAI,CAACtC,OAAO,CAACmB,aAAa,EAAE,OAAOnB,OAAO,CAACoB,QAAQ;MACnD,IAAI,CAACpB,OAAO,CAACqB,iBAAiB,EAAE,OAAOrB,OAAO,CAACsB,YAAY;MAC3D,IAAI,CAACtB,OAAO,CAACyB,kBAAkB,EAAE,OAAOzB,OAAO,CAAC0B,aAAa;MAC7D,IAAI,CAAC1B,OAAO,CAAC2B,mBAAmB,EAAE,OAAO3B,OAAO,CAAC4B,cAAc;MAC/D,IAAI,CAAC5B,OAAO,CAAC6B,kBAAkB,EAAE,OAAO7B,OAAO,CAAC8B,aAAa;MAC7D,IAAI,CAAC9B,OAAO,CAAC+B,gBAAgB,EAAE,OAAO/B,OAAO,CAACgC,WAAW;MAGzD,IAAII,YAAY,EAAE;QACd;QACA,MAAM5B,mBAAmB,CAAC4B,YAAY,CAACnD,EAAE,EAAEe,OAAO,EAAEC,MAAM,CAAC;QAC3D7D,KAAK,CAAC4I,OAAO,CAAC,6CAA6C,CAAC;MAChE,CAAC,MAAM;QACH;QACA,MAAMjF,mBAAmB,CAACC,OAAO,EAAEC,MAAM,CAAC;QAC1C7D,KAAK,CAAC4I,OAAO,CAAC,wCAAwC,CAAC;MAC3D;MACA7C,aAAa,CAAC,CAAC;MACfvD,OAAO,CAAC,CAAC;IACb,CAAC,CAAC,OAAO4E,KAAK,EAAE;MACZnD,OAAO,CAACmD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAACjD,OAAO,CAAC;MACpD;MACAnE,KAAK,CAACoH,KAAK,CAAC,6EAA6E,CAAC;IAC9F,CAAC,SAAS;MACNX,UAAU,CAAC,KAAK,CAAC;IACrB;EACJ,CAAC;EAED,MAAMoC,eAAe,GAAGA,CAAC1F,IAAI,EAAE2F,aAAa,EAAEC,UAAU,EAAEC,QAAQ,KAAK;IACnE,IAAIC,OAAO,GAAG,0FAA0F;IAExGA,OAAO,IAAI,6EAA6E;IAExF,IAAIF,UAAU,EAAE;MACZE,OAAO,IAAI,+CAA+C;IAC9D,CAAC,MAAM;MACHA,OAAO,IAAI,yBAAyB;IACxC;IAEA,IAAIvC,MAAM,CAACvD,IAAI,CAAC,EAAE;MACd8F,OAAO,IAAI,kBAAkB;IACjC;IAEA,IAAID,QAAQ,EAAE;MACVC,OAAO,IAAI,uBAAuB;IACtC;IAEA,OAAOA,OAAO,CAACb,IAAI,CAAC,CAAC;EACzB,CAAC;EAED,MAAMc,WAAW,GAAGA,CAACC,KAAK,EAAEhG,IAAI,EAAEH,IAAI,GAAG,MAAM,EAAEoG,QAAQ,GAAG,IAAI,EAAEC,aAAa,GAAG,KAAK,EAAEC,oBAAoB,GAAG,IAAI,KAAK;IACrH,MAAMC,UAAU,GAAGvG,IAAI,KAAK,UAAU;IACtC,MAAMgG,QAAQ,GAAGhG,IAAI,KAAK,QAAQ;IAElC,MAAM8F,aAAa,GAAG3F,IAAI,CAACqG,UAAU,CAAC,QAAQ,CAAC;IAC/C,IAAIT,UAAU,GAAG,KAAK;;IAEtB;IACA,IAAI5F,IAAI,KAAK,UAAU,EAAE;MACrB4F,UAAU,GAAG,CAAC7C,QAAQ,CAACnB,aAAa;IACxC,CAAC,MAAM,IAAI5B,IAAI,KAAK,cAAc,EAAE;MAChC4F,UAAU,GAAG,CAAC7C,QAAQ,CAACjB,iBAAiB;IAC5C,CAAC,MAAM,IAAI6D,aAAa,IAAI3F,IAAI,KAAK,gBAAgB,EAAE;MACnD,MAAMsG,YAAY,GAAGtG,IAAI,CAACuG,OAAO,CAAC,QAAQ,EAAE,aAAa,CAAC;MAC1DX,UAAU,GAAG,CAAC7C,QAAQ,CAACuD,YAAY,CAAC;IACxC;IAEA,MAAME,oBAAoB,GAAIhH,CAAC,IAAK;MAChC,IAAIQ,IAAI,KAAK,eAAe,EAAE;QAC1B2E,qBAAqB,CAACnF,CAAC,EAAE,UAAU,CAAC;MACxC,CAAC,MAAM,IAAIQ,IAAI,KAAK,mBAAmB,EAAE;QACrC2E,qBAAqB,CAACnF,CAAC,EAAE,cAAc,CAAC;MAC5C,CAAC,MAAM,IAAI0G,aAAa,EAAE;QACtB;QACArB,qBAAqB,CAACrF,CAAC,EAAE2G,oBAAoB,CAAC;MAClD,CAAC,MAAM;QACH;QACA5B,YAAY,CAAC/E,CAAC,CAAC;MACnB;IACJ,CAAC;IAED,MAAMiH,aAAa,GAAIzG,IAAI,KAAK,UAAU,IAAI+C,QAAQ,CAACnB,aAAa,IAAM5B,IAAI,KAAK,cAAc,IAAI+C,QAAQ,CAACjB,iBAAkB;IAChI;IACA,MAAM4E,aAAa,GAAGT,QAAQ,IAAIQ,aAAa,IAAKd,aAAa,IAAI5C,QAAQ,CAAC/C,IAAI,CAACuG,OAAO,CAAC,QAAQ,EAAE,aAAa,CAAC,CAAE;IAErH,oBACI/I,OAAA;MAAgBiB,SAAS,EAAC,UAAU;MAAAC,QAAA,gBAChClB,OAAA;QAAOiB,SAAS,EAAC,2CAA2C;QAAAC,QAAA,GACvDsH,KAAK,EAAC,GAAC,EAAC,CAACC,QAAQ,IAAIQ,aAAa,kBAAKjJ,OAAA;UAAMiB,SAAS,EAAC,cAAc;UAAAC,QAAA,EAAC;QAAC;UAAAI,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC5E,CAAC,EAEP4G,QAAQ,gBACLrI,OAAA;QACIwC,IAAI,EAAEA,IAAK;QACXwE,KAAK,EAAEzB,QAAQ,CAAC/C,IAAI,CAAC,IAAI,EAAG;QAC5B2G,QAAQ,EAAEpC,YAAa;QACvB9F,SAAS,EAAEiH,eAAe,CAAC1F,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,CAAE;QAAAtB,QAAA,gBAErDlB,OAAA;UAAQgH,KAAK,EAAC,EAAE;UAAA9F,QAAA,EAAC;QAAa;UAAAI,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,EACtC,CAACe,IAAI,KAAK,OAAO,GAAGiD,MAAM,GAAGE,YAAY,EAAEyD,GAAG,CAACC,IAAI,iBAChDrJ,OAAA;UAAsBgH,KAAK,EAAEqC,IAAI,CAACnH,EAAG;UAAAhB,QAAA,EAAEmI,IAAI,CAAC7G;QAAI,GAAnC6G,IAAI,CAACnH,EAAE;UAAAZ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAqC,CAC5D,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACE,CAAC,GACTmH,UAAU,gBACV5I,OAAA;QAAKiB,SAAS,EAAC,+BAA+B;QAAAC,QAAA,eAC1ClB,OAAA;UACIqC,IAAI,EAAC,UAAU;UACfG,IAAI,EAAEA,IAAK;UACXyE,OAAO,EAAE1B,QAAQ,CAAC/C,IAAI,CAAE;UACxB2G,QAAQ,EAAEH,oBAAqB;UAC/B/H,SAAS,EAAC;QAAuE;UAAAK,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACpF;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC,gBAENzB,OAAA;QACIqC,IAAI,EAAEA,IAAK;QACXG,IAAI,EAAEA,IAAK;QACXwE,KAAK,EAAEzB,QAAQ,CAAC/C,IAAI,CAAC,IAAI,EAAG;QAC5B2G,QAAQ,EAAEpC,YAAa;QACvB9F,SAAS,EAAEiH,eAAe,CAAC1F,IAAI,EAAE2F,aAAa,EAAEC,UAAU,EAAE,KAAK,CAAE;QACnEkB,QAAQ,EAAElB,UAAW;QACrBmB,WAAW,EAAEnB,UAAU,GAAG,KAAK,GAAI5F,IAAI,CAACqG,UAAU,CAAC,MAAM,CAAC,GAAG,uBAAuB,GAAG;MAAI;QAAAvH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC9F,CACJ,EAEAsE,MAAM,CAACvD,IAAI,CAAC,iBAAIxC,OAAA;QAAGiB,SAAS,EAAC,uCAAuC;QAAAC,QAAA,EAAE6E,MAAM,CAACvD,IAAI;MAAC;QAAAlB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC;IAAA,GAvClFe,IAAI;MAAAlB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAwCT,CAAC;EAEd,CAAC;EAGD,oBACIzB,OAAA,CAAC2B,KAAK;IACFC,IAAI,EAAEA,IAAK;IACXC,OAAO,EAAEA,OAAQ;IACjBC,KAAK,EAAEuD,YAAY,GAAG,0BAA0B,GAAG,yBAA0B;IAAAnE,QAAA,eAE7ElB,OAAA;MAAMwJ,QAAQ,EAAE7B,YAAa;MAAC1G,SAAS,EAAC,WAAW;MAAAC,QAAA,gBAE/ClB,OAAA;QAAKiB,SAAS,EAAC,uCAAuC;QAAAC,QAAA,GAGjDqH,WAAW,CAAC,eAAe,EAAE,gBAAgB,CAAC,EAC9CA,WAAW,CAAC,OAAO,EAAE,OAAO,EAAE,QAAQ,CAAC,EACvCA,WAAW,CAAC,gBAAgB,EAAE,aAAa,EAAE,QAAQ,CAAC,eACvDvI,OAAA;UAAKiB,SAAS,EAAC;QAAe;UAAAK,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,KAAC,eAGtCzB,OAAA;UAAKiB,SAAS,EAAC,wCAAwC;UAAAC,QAAA,eACnDlB,OAAA;YAAIiB,SAAS,EAAC,sCAAsC;YAAAC,QAAA,EAAC;UAA4B;YAAAI,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACrF,CAAC,EAEL8G,WAAW,CAAC,YAAY,EAAE,YAAY,CAAC,EACvCA,WAAW,CAAC,iBAAiB,EAAE,iBAAiB,EAAE,MAAM,EAAE,KAAK,CAAC,EAEhEA,WAAW,CAAC,gBAAgB,EAAE,KAAK,CAAC,EACpCA,WAAW,CAAC,gCAAgC,EAAE,gBAAgB,CAAC,eAIhEvI,OAAA;UAAKiB,SAAS,EAAC,wCAAwC;UAAAC,QAAA,eACnDlB,OAAA;YAAIiB,SAAS,EAAC,sCAAsC;YAAAC,QAAA,EAAC;UAAiC;YAAAI,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC1F,CAAC,eAGNzB,OAAA;UAAKiB,SAAS,EAAC,oDAAoD;UAAAC,QAAA,GAC9DqH,WAAW,CAAC,uBAAuB,EAAE,eAAe,EAAE,UAAU,EAAE,KAAK,EAAE,IAAI,EAAE,UAAU,CAAC,EAC1FA,WAAW,CAAC,mBAAmB,EAAE,UAAU,EAAE,MAAM,EAAE,KAAK,CAAC;QAAA;UAAAjH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC3D,CAAC,eAGNzB,OAAA;UAAKiB,SAAS,EAAC,oDAAoD;UAAAC,QAAA,GAC9DqH,WAAW,CAAC,2BAA2B,EAAE,mBAAmB,EAAE,UAAU,EAAE,KAAK,EAAE,IAAI,EAAE,cAAc,CAAC,EACtGA,WAAW,CAAC,sBAAsB,EAAE,cAAc,EAAE,MAAM,EAAE,KAAK,CAAC;QAAA;UAAAjH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAClE,CAAC,eAGNzB,OAAA;UAAKiB,SAAS,EAAC,+BAA+B;UAAAC,QAAA,EACzCqH,WAAW,CAAC,0BAA0B,EAAE,0BAA0B,EAAE,UAAU,EAAE,KAAK;QAAC;UAAAjH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACtF,CAAC,eAGNzB,OAAA;UAAKiB,SAAS,EAAC,wCAAwC;UAAAC,QAAA,eACnDlB,OAAA;YAAIiB,SAAS,EAAC,sCAAsC;YAAAC,QAAA,EAAC;UAAmB;YAAAI,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC5E,CAAC,eAGNzB,OAAA;UAAKiB,SAAS,EAAC,gEAAgE;UAAAC,QAAA,GAG1EqH,WAAW,CAAC,mBAAmB,EAAE,gBAAgB,EAAE,MAAM,EAAE,KAAK,CAAC,eAClEvI,OAAA;YAAKiB,SAAS,EAAC,gBAAgB;YAAAC,QAAA,EAAEqH,WAAW,CAAC,oBAAoB,EAAE,oBAAoB,EAAE,UAAU,EAAE,KAAK;UAAC;YAAAjH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAElHzB,OAAA;YAAKiB,SAAS,EAAC,oDAAoD;YAAAC,QAAA,GAC9DqH,WAAW,CAAC,oBAAoB,EAAE,oBAAoB,EAAE,UAAU,EAAE,KAAK,EAAE,IAAI,EAAE,eAAe,CAAC,EACjGA,WAAW,CAAC,kBAAkB,EAAE,eAAe,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK,CAAC;UAAA;YAAAjH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACtE,CAAC,eACNzB,OAAA;YAAKiB,SAAS,EAAC,oDAAoD;YAAAC,QAAA,GAC9DqH,WAAW,CAAC,qBAAqB,EAAE,qBAAqB,EAAE,UAAU,EAAE,KAAK,EAAE,IAAI,EAAE,gBAAgB,CAAC,EACpGA,WAAW,CAAC,mBAAmB,EAAE,gBAAgB,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK,CAAC;UAAA;YAAAjH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACxE,CAAC,eAENzB,OAAA;YAAKiB,SAAS,EAAC,oDAAoD;YAAAC,QAAA,GAC9DqH,WAAW,CAAC,oBAAoB,EAAE,oBAAoB,EAAE,UAAU,EAAE,KAAK,EAAE,IAAI,EAAE,eAAe,CAAC,EACjGA,WAAW,CAAC,kBAAkB,EAAE,eAAe,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK,CAAC;UAAA;YAAAjH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACtE,CAAC,eACNzB,OAAA;YAAKiB,SAAS,EAAC,oDAAoD;YAAAC,QAAA,GAC9DqH,WAAW,CAAC,kBAAkB,EAAE,kBAAkB,EAAE,UAAU,EAAE,KAAK,EAAE,IAAI,EAAE,aAAa,CAAC,EAC3FA,WAAW,CAAC,gBAAgB,EAAE,aAAa,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK,CAAC;UAAA;YAAAjH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAClE,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACL,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL,CAAC,eAGNzB,OAAA;QAAKiB,SAAS,EAAC,+CAA+C;QAAAC,QAAA,gBAC1DlB,OAAA;UACIqC,IAAI,EAAC,QAAQ;UACbD,OAAO,EAAEP,OAAQ;UACjBZ,SAAS,EAAC,8IAA8I;UACxJqI,QAAQ,EAAEzD,OAAQ;UAAA3E,QAAA,EACrB;QAED;UAAAI,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACTzB,OAAA;UACIqC,IAAI,EAAC,QAAQ;UACbpB,SAAS,EAAC,iLAAiL;UAC3LqI,QAAQ,EAAEzD,OAAO,IAAI,CAACK,gBAAiB;UAAAhF,QAAA,EAEtC2E,OAAO,GAAG,cAAc,GAAG;QAAgB;UAAAvE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACR,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACJ;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACJ,CAAC;AAEhB,CAAC;;AAED;AACA;AAAA6D,EAAA,CAxZMH,sBAAsB;AAAAsE,GAAA,GAAtBtE,sBAAsB;AAyZ5B,MAAMuE,GAAG,GAAGA,CAAA,KAAM;EAAAC,GAAA;EACd,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAG1K,QAAQ,CAAC,KAAK,CAAC;;EAEjD;EACA,IAAI,OAAOE,KAAK,KAAK,WAAW,EAAE;IAC9ByK,MAAM,CAACzK,KAAK,GAAG;MACX4I,OAAO,EAAG8B,GAAG,IAAKzG,OAAO,CAACC,GAAG,CAAC,UAAU,EAAEwG,GAAG,CAAC;MAC9CtD,KAAK,EAAGsD,GAAG,IAAKzG,OAAO,CAACmD,KAAK,CAAC,QAAQ,EAAEsD,GAAG;IAC/C,CAAC;EACL;;EAEA;EACA,MAAMC,iBAAiB,GAAGA,CAAA,KAAM;IAC5B1G,OAAO,CAACC,GAAG,CAAC,oEAAoE,CAAC;EACrF,CAAC;EAED,oBACIvD,OAAA;IAAKiB,SAAS,EAAC,6BAA6B;IAAAC,QAAA,gBACxClB,OAAA;MAAIiB,SAAS,EAAC,4CAA4C;MAAAC,QAAA,EAAC;IAE3D;MAAAI,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eACLzB,OAAA;MACIoC,OAAO,EAAEA,CAAA,KAAMyH,YAAY,CAAC,IAAI,CAAE;MAClC5I,SAAS,EAAC,oGAAoG;MAAAC,QAAA,EACjH;IAED;MAAAI,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC,eAETzB,OAAA,CAACmF,sBAAsB;MACnBvD,IAAI,EAAEgI,SAAU;MAChB/H,OAAO,EAAEA,CAAA,KAAMgI,YAAY,CAAC,KAAK,CAAE;MACnCzE,aAAa,EAAE4E,iBAAkB;MACjC3E,YAAY,EAAE,IAAK,CAAC;IAAA;MAAA/D,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACvB,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACD,CAAC;AAEd,CAAC;AAACkI,GAAA,CApCID,GAAG;AAAAO,GAAA,GAAHP,GAAG;AAsCT,eAAeA,GAAG;AAAC,IAAAhI,EAAA,EAAAY,GAAA,EAAAmH,GAAA,EAAAQ,GAAA;AAAAC,YAAA,CAAAxI,EAAA;AAAAwI,YAAA,CAAA5H,GAAA;AAAA4H,YAAA,CAAAT,GAAA;AAAAS,YAAA,CAAAD,GAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}